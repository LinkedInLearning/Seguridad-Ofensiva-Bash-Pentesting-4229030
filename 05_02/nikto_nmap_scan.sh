#!/bin/bash

# Verificar si se proporciona una red objetivo
if [ -z "$1" ]; then
    echo "Uso: $0 <red>"
    exit 1
fi

NETWORK=$1

# Escaneo de red para descubrir hosts activos con puerto 80 abierto
echo "Escaneando red $NETWORK para encontrar hosts activos con puerto 80 abierto..."
nmap -p 80 --open $NETWORK -oG nmap_results.txt

# Crear directorio para guardar los resultados de Nikto
mkdir -p resultados

# Extraer IPs activas y escanearlas con Nikto
grep Up nmap_results.txt | awk '{print $2}' | while read -r ip; do
  echo "Escaneando $ip con Nikto..."
  nikto -h "$ip" -o "resultados/$ip.txt" -Format txt
done

echo "Escaneos completados. Resultados guardados en el directorio 'resultados'."
