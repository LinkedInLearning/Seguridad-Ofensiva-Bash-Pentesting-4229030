#!/bin/bash

# Variables
REPOSITORIO="https://github.com/usuario/repositorio.git"
JENKINS_URL="http://jenkins-server.com/job/nombre-del-job/build"
SLACK_WEBHOOK_URL="https://hooks.slack.com/services/xxx/yyy/zzz"
COMMIT_HASH=$(git log -1 --format="%h")
COMMIT_AUTHOR=$(git log -1 --format="%an")
COMMIT_MESSAGE=$(git log -1 --format="%s")

# Paso 1: Lanzar una compilación en Jenkins
echo "[+] Lanzando compilación en Jenkins..."
curl -X POST $JENKINS_URL

# Paso 2: Notificar a Slack
echo "[+] Enviando notificación a Slack..."
curl -X POST -H 'Content-type: application/json' \
    --data "{\"text\":\"Nuevo commit en el repositorio: $COMMIT_HASH por $COMMIT_AUTHOR - $COMMIT_MESSAGE\"}" \
    $SLACK_WEBHOOK_URL

echo "Proceso completado."
